{% extends "base.html" %}
{% block content %}
<div class="dashboard-container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-hand-holding-usd me-2"></i>Donor Dashboard</h2>
    <div class="text-muted"><i class="fas fa-user-circle me-2"></i>{{ current_user.username }}</div>
  </div>

  <!-- Stats Cards -->
  <div class="row g-3 mb-4">
    <div class="col-md-4">
      <div class="card stat-card">
        <h3>${{ "{:,.2f}".format(donation_stats.total_donations) }}</h3>
        <p>Total Donations</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card stat-card">
        <h3>{{ donation_stats.projects_supported }}</h3>
        <p>Projects Supported</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card stat-card">
        <h3>{{ donation_stats.impact_score }}%</h3>
        <p>Impact Score</p>
      </div>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-lg-8">
      <!-- Interactive Map & Dashboards -->
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0"><i class="fas fa-globe me-2"></i>Interactive Map & Impact</h5>
        </div>
        <div class="card-body">
          <div class="ratio ratio-16x9 mb-3">
            <div id="map" class="rounded"></div>
          </div>
          <div class="alert alert-info">
            <p class="mb-0"><strong>Currency Tracing:</strong> {{ donation_stats.currency_trace }} <i class="fas fa-chart-line ms-2"></i></p>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-4">
      <!-- Quick Actions -->
      <div class="card mb-3">
        <div class="card-header"><h5 class="mb-0">Quick Actions</h5></div>
        <div class="card-body d-grid gap-2">
          <button class="btn btn-primary"><i class="fas fa-donate me-2"></i>Make Donation</button>
          <button class="btn btn-outline-primary"><i class="fas fa-file-alt me-2"></i>View Reports</button>
          <button class="btn btn-outline-primary"><i class="fas fa-bell me-2"></i>Donation Alerts</button>
        </div>
      </div>
      
      <!-- Donation Insights -->
      <div class="card">
        <div class="card-header"><h5 class="mb-0">Donation Insights</h5></div>
        <div class="card-body">
          <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <strong>Project Analytics</strong>
              <br><small>Track the impact of your donations</small>
            </li>
            <li class="list-group-item">
              <strong>Beneficiary Stories</strong>
              <br><small>See how your donations are changing lives</small>
            </li>
            <li class="list-group-item">
              <strong>Impact Reports</strong>
              <br><small>Detailed quarterly impact assessments</small>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Leaflet CSS and JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
  // Initialize the map
  var map = L.map('map').setView([-30, 25], 5);
  
  // Add OpenStreetMap tiles
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data Â© <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
  }).addTo(map);
</script>
{% endblock %}
